# –ê–Ω–∞–ª–∏–∑ –¥–∏–Ω–∞–º–∏–∫–∏ COVID-19 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –º–æ–¥–µ–ª–∏

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ COVID-19 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ PyMC (–≤–µ—Ä—Å–∏—è > 3). –ú–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–µ —á–∏—Å–ª–æ R(t) –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä **–ê–Ω–∞–ª–∏–∑ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∏—Å–ª–∞ R(t)** - –æ—Ü–µ–Ω–∫–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–µ–∫—Ü–∏–∏
- üîÆ **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–µ–º–æ—Å—Ç–∏** - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–æ–≤—ã—Ö —Å–ª—É—á–∞–µ–≤
- üåç **–ú—É–ª—å—Ç–∏—Å—Ç—Ä–∞–Ω–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑** - —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∞—Ö
- üìà **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - –≥—Ä–∞—Ñ–∏–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã
- üéØ **–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞** - –æ—Ü–µ–Ω–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤

### –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–µ —Å—Ç—Ä–∞–Ω—ã

- üá∑üá∫ **–†–æ—Å—Å–∏—è** (Russia)
- üáÆüáπ **–ò—Ç–∞–ª–∏—è** (Italy) 
- üá©üá™ **–ì–µ—Ä–º–∞–Ω–∏—è** (Germany)
- üá´üá∑ **–§—Ä–∞–Ω—Ü–∏—è** (France)

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã

- **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏**: 01.01.2020 - 01.12.2020
- **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ**: 02.12.2020 - 14.12.2020
- **–ü–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: –∞–Ω–∞–ª–∏–∑ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 100 —Å–ª—É—á–∞–µ–≤ –≤ –¥–µ–Ω—å

## –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å

### –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è

```
log(R(t)) = log(R(t-1)) + Œµ(t), –≥–¥–µ Œµ(t) ~ Normal(0, œÉ_rw)
Œº(t) = R(t) * Œ£[w(s) * y(t-s)] –¥–ª—è s –æ—Ç 1 –¥–æ max_lag
y(t) ~ NegativeBinomial(Œº(t), Œ±)
```

### –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- **R(t)** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–µ —á–∏—Å–ª–æ
- **œÉ_rw = 0.07** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –±–ª—É–∂–¥–∞–Ω–∏—è
- **Œ± ~ LogNormal(log(60), 0.5)** - –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ-–±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- **max_lag = 15** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —É—á–µ—Ç–∞ –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç–∏
- **–°–µ—Ä–∏–π–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª**: —Å—Ä–µ–¥–Ω–µ–µ = 4.0 –¥–Ω—è, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ = 2.0 –¥–Ω—è

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞

### –°–≤–æ–¥–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤

–î–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ `outputs_rt_model/metrics_summary.csv`:

| –°—Ç—Ä–∞–Ω–∞ | MAE (Mean Absolute Error) | MAPE (%) (Mean Absolute Percentage Error) |
|--------|---------------------------|-------------------------------------------|
| üá∑üá∫ –†–æ—Å—Å–∏—è | 10,714.6 | 39.2% |
| üáÆüáπ –ò—Ç–∞–ª–∏—è | 4,596.3 | 28.0% |
| üá©üá™ –ì–µ—Ä–º–∞–Ω–∏—è | 4,743.2 | 20.8% |
| üá´üá∑ –§—Ä–∞–Ω—Ü–∏—è | 7,536.3 | 58.8% |

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

- **–ì–µ—Ä–º–∞–Ω–∏—è** –ø–æ–∫–∞–∑–∞–ª–∞ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å MAPE = 20.8%, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∞
- **–ò—Ç–∞–ª–∏—è** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å MAPE = 28.0%
- **–†–æ—Å—Å–∏—è** –∏–º–µ–µ—Ç —É–º–µ—Ä–µ–Ω–Ω—É—é –æ—à–∏–±–∫—É –ø—Ä–æ–≥–Ω–æ–∑–∞ (MAPE = 39.2%)
- **–§—Ä–∞–Ω—Ü–∏—è** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –æ—à–∏–±–∫—É –ø—Ä–æ–≥–Ω–æ–∑–∞ (MAPE = 58.8%), —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏ –¥–∏–Ω–∞–º–∏–∫–∏ —ç–ø–∏–¥–µ–º–∏–∏ –≤ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–µ

## –ì—Ä–∞—Ñ–∏–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### üá∑üá∫ –†–æ—Å—Å–∏—è (Russia)

#### –î–∏–Ω–∞–º–∏–∫–∞ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∏—Å–ª–∞ R(t)
![Russia R(t)](outputs_rt_model/Russia/Russia_Rt.png)

#### –ü—Ä–æ–≥–Ω–æ–∑ vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
![Russia Forecast](outputs_rt_model/Russia/Russia_Forecast_vs_Actual.png)

### üáÆüáπ –ò—Ç–∞–ª–∏—è (Italy)

#### –î–∏–Ω–∞–º–∏–∫–∞ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∏—Å–ª–∞ R(t)
![Italy R(t)](outputs_rt_model/Italy/Italy_Rt.png)

#### –ü—Ä–æ–≥–Ω–æ–∑ vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
![Italy Forecast](outputs_rt_model/Italy/Italy_Forecast_vs_Actual.png)

### üá©üá™ –ì–µ—Ä–º–∞–Ω–∏—è (Germany)

#### –î–∏–Ω–∞–º–∏–∫–∞ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∏—Å–ª–∞ R(t)
![Germany R(t)](outputs_rt_model/Germany/Germany_Rt.png)

#### –ü—Ä–æ–≥–Ω–æ–∑ vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
![Germany Forecast](outputs_rt_model/Germany/Germany_Forecast_vs_Actual.png)

### üá´üá∑ –§—Ä–∞–Ω—Ü–∏—è (France)

#### –î–∏–Ω–∞–º–∏–∫–∞ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∏—Å–ª–∞ R(t)
![France R(t)](outputs_rt_model/France/France_Rt.png)

#### –ü—Ä–æ–≥–Ω–æ–∑ vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
![France Forecast](outputs_rt_model/France/France_Forecast_vs_Actual.png)


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

```bash
pip install numpy pandas matplotlib scipy pymc pytensor
```

### –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞

```python
python solution.py
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞

- `run_fit=True` - –ø–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å MCMC —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- `run_fit=False` - —Ç–æ–ª—å–∫–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

1. **–°—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ R(t)** - —Å–ª—É—á–∞–π–Ω–æ–µ –±–ª—É–∂–¥–∞–Ω–∏–µ –≤ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ
2. **–£—á–µ—Ç –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç–∏** - –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞ —Å–ª—É—á–∞–µ–≤ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –¥–Ω–∏
3. **–ù–µ–≥–∞—Ç–∏–≤–Ω–æ-–±–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** - –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤
4. **MCMC —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** - –±–∞–π–µ—Å–æ–≤—Å–∫–∏–π –≤—ã–≤–æ–¥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NUTS —Å—ç–º–ø–ª–µ—Ä–∞

### –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è

1. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—ç–º–ø–ª–æ–≤ R(t) –∏–∑ –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—ç–º–ø–ª–∞
4. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫ (–º–µ–¥–∏–∞–Ω–∞, HDI –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã)

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

- **MAE (Mean Absolute Error)** - —Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞
- **MAPE (Mean Absolute Percentage Error)** - —Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è –æ—à–∏–±–∫–∞
- **HDI (Highest Density Interval)** - –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –Ω–∞–∏–≤—ã—Å—à–µ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏


---

## 1) –î–∞–Ω–Ω—ã–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

- –ë–µ—Ä—ë–º –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ **–Ω–æ–≤—ã–µ —Å–ª—É—á–∞–∏** `new_cases` –∏–∑ OWID.
- –û—Å—Ç–∞–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª:  
**–æ–±—É—á–µ–Ω–∏–µ** ‚Äî `2020-01-01 ‚Ä¶ 2020-12-01` (train),  
**–ø—Ä–æ–≥–Ω–æ–∑** ‚Äî `2020-12-02 ‚Ä¶ 2020-12-14` (forecast).
- –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω—ã –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –¥–Ω–∏ –¥–æ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è –≤ train, –∫–æ–≥–¥–∞ —Å–ª—É—á–∞–µ–≤ $\ge 100$.
- –ü–æ–ª—É—á–∞–µ–º:
- `y_obs` ‚Äî –º–∞—Å—Å–∏–≤ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (–ø–æ—Å–ª–µ –ø–æ—Ä–æ–≥–∞),
- –∏ –æ–∫–Ω–æ –¥–∞—Ç –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞.

---

## 2) –ò–¥–µ—è –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –º–æ–¥–µ–ª–∏ (renewal / ¬´–≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ¬ª)

–°–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ —Å–ª—É—á–∞–∏ –º–æ–¥–µ–ª–∏—Ä—É—é—Ç—Å—è –∫–∞–∫
$$
\mu_t \;=\; R_t \cdot \sum_{s=1}^{S} w_s \, y_{t-s},
$$
–≥–¥–µ $\mu_t$ ‚Äî –æ–∂–∏–¥–∞–µ–º—ã–µ —Å–ª—É—á–∞–∏ –≤ –¥–µ–Ω—å $t$, $R_t$ ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–µ —á–∏—Å–ª–æ, $w_s$ ‚Äî –≤–µ—Å–∞ —Å–µ—Ä–∏–π–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞, $S$ ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ (–≤ –∫–æ–¥–µ `MAX_LAG = 15`).

**–°–µ—Ä–∏–π–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª** $w_s$ –ø–æ–ª—É—á–∞–µ–º –∏–∑ –≥–∞–º–º–∞‚Äë—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º mean/sd) –∏ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∏—Ä—É–µ–º –ø–æ –¥–Ω—è–º, –ø–æ—Ç–æ–º –Ω–æ—Ä–º–∏—Ä—É–µ–º $\sum_s w_s = 1$.

---

## 3) –ö–∞–∫ –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º $R_t$

–î–µ–ª–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –±–ª—É–∂–¥–∞–Ω–∏–µ –Ω–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–µ:
$$
\log R_t \;=\; \log R_{t-1} + \varepsilon_t,\qquad
\varepsilon_t \sim \mathcal{N}(0,\sigma_{\text{rw}}^2).
$$

–ù–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: $\log R_0 \sim \mathcal{N}(\log 1.1,\,0.3^2)$. –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å $R_t$ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–æ–π $R_t=\exp(\log R_t)$.

---

## 4) –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å (–æ–≤–µ—Ä–¥–∏—Å–ø–µ—Ä—Å–∏—è)

–ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ‚Äë–±–∏–Ω–æ–º–∏–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å:
$$
y_t \sim \mathrm{NegBinomial}(\mu_t,\alpha),\qquad
\mathbb{E}[y_t]=\mu_t,\ \ \mathrm{Var}(y_t)=\mu_t+\frac{\mu_t^2}{\alpha}.
$$

–ü—Ä–∏–æ—Ä –Ω–∞ –æ–≤–µ—Ä–¥–∏—Å–ø–µ—Ä—Å–∏—é: $\log \alpha \sim \mathcal{N}(\log 60,\ 0.5^2)$ ‚Äî –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –Ω–µ ¬´—Ä–∞–∑–¥—É–≤–∞—é—Ç—Å—è¬ª.

---

## 5) ¬´–ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏¬ª (generative story)

1) –°—ç–º–ø–ª–∏—Ä—É–µ–º –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã: $\sigma_{\text{rw}}$, $\alpha$, $\log R_0$.  
2) –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é $\log R_t$ –∏ $R_t$.  
3) –°—á–∏—Ç–∞–µ–º –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å $\sum_s w_s y_{t-s}$.  
4) –ü–æ–ª—É—á–∞–µ–º $\mu_t = R_t \cdot \text{infectiousness}_t$.  
5) –ù–∞–±–ª—é–¥–µ–Ω–∏—è: $y_t \sim \mathrm{NegBinomial}(\mu_t,\alpha)$.

–ù–∞ –æ–±—É—á–µ–Ω–∏–∏ NUTS –Ω–∞—Ö–æ–¥–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É—é—â–∏–µ –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å.

---

## 6) –°—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (Bayesian inference)

–ò—Å–ø–æ–ª—å–∑—É–µ–º NUTS (HMC) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω—ã—Ö —Å—ç–º–ø–ª–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –∫—Ä–∏–≤–æ–π $R_t$. –í–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: `chains`, `draws`, `tune`, `target_accept`.

---

## 7) –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–≥–æ —Å—ç–º–ø–ª–∞:
$$
\Lambda_t = \sum_{s=1}^{S} w_s \, \tilde y_{t-s},\qquad
\mu_t = R_t \cdot \Lambda_t,\qquad
\tilde y_t \sim \mathrm{NegBinomial}(\mu_t,\alpha),
$$
–≥–¥–µ $\tilde y_{t-s}$ ‚Äî ¬´–∏—Å—Ç–æ—Ä–∏—è¬ª —Å —É—á—ë—Ç–æ–º —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. –ü–æ –æ–±–ª–∞–∫—É —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π –±–µ—Ä—ë–º –º–µ–¥–∏–∞–Ω—É –∏ 90% HDI.

---

## 8) –ú–µ—Ç—Ä–∏–∫–∏

MAE –∏ MAPE:
$$
\mathrm{MAE}=\frac{1}{n}\sum_t |y_t-\hat y_t|,\qquad
\mathrm{MAPE} = \frac{100\%}{n}\sum_t \frac{|y_t-\hat y_t|}{\max(y_t,1)}.
$$

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–∞–∫–∂–µ WAPE, sMAPE –∏ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ —Å–≥–ª–∞–∂–µ–Ω–Ω–æ–º—É MA‚Äë7.
"""

formal_md = r"""# –§–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ (MathJax)

## 1) –°–µ—Ä–∏–π–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—è)

–ò–∑ –≥–∞–º–º–∞‚Äë—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
$$
k=\left(\frac{\text{mean}}{\text{sd}}\right)^2,\qquad
\theta=\frac{\text{sd}^2}{\text{mean}},
$$
—Å—Ç—Ä–æ–∏–º CDF $F$ –∏ –∑–∞–¥–∞—ë–º PMF:
$$
w_s = F\!\big(s+\tfrac12\big)-F\!\big(s-\tfrac12\big),\quad s=1,\dots,S,\qquad
\sum_{s=1}^{S} w_s = 1.
$$

–ò–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –Ω–∞ train:
$$
\Lambda_t = \sum_{s=1}^{\min(S,\,t-1)} w_s \, y_{t-s}.
$$

## 2) –ü—Ä–æ—Ü–µ—Å—Å $R_t$ –∏ —Å—Ä–µ–¥–Ω–µ–µ $\mu_t$

–°–ª—É—á–∞–π–Ω–æ–µ –±–ª—É–∂–¥–∞–Ω–∏–µ –Ω–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–µ:
$$
\log R_0 \sim \mathcal{N}(\log 1.1,\,0.3^2),\qquad
\varepsilon_t \sim \mathcal{N}(0,\sigma_{\text{rw}}^2),\quad
\log R_t = \log R_{t-1} + \varepsilon_t,\quad
R_t=\exp(\log R_t).
$$

–õ–∏–Ω–∫ –∫ —Å—Ä–µ–¥–Ω–µ–º—É –Ω–∞ train:
$$
\mu_t = R_t \cdot \Lambda_t,\qquad t=1,\dots,T_{\text{train}}.
$$

## 3) –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏–µ

–ü—Ä–∏–æ—Ä –Ω–∞ –æ–≤–µ—Ä–¥–∏—Å–ø–µ—Ä—Å–∏—é:
$$
\log \alpha \sim \mathcal{N}(\log 60,\ 0.5^2).
$$

–õ–∏–∫–µ–ª–∏—Ö—É–¥:
$$
y_t \mid \mu_t,\alpha \sim \mathrm{NegBinomial}(\mu_t,\alpha),\qquad
\mathbb{E}[y_t]=\mu_t,\quad \mathrm{Var}(y_t)=\mu_t+\frac{\mu_t^2}{\alpha}.
$$

## 4) –ü–æ–ª–Ω–∞—è –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å

–û–±–æ–∑–Ω–∞—á–∏–º $\theta=\{\log R_0,\{\varepsilon_t\},\sigma_{\text{rw}},\alpha\}$. –¢–æ–≥–¥–∞
$$
\begin{aligned}
p(\theta \mid y_{1:T_{\text{train}}})
&\propto
\prod_{t=1}^{T_{\text{train}}} \mathrm{NegBinomial}\!\big(y_t \mid \mu_t(\theta), \alpha\big)\;
\cdot\; \mathcal{N}\!\big(\log R_0 \mid \log 1.1, 0.3^2\big)\\
&\quad\cdot\;
\prod_{t=1}^{T_{\text{total}}-1} \mathcal{N}\!\big(\varepsilon_t \mid 0,\sigma_{\text{rw}}^2\big)\;
\cdot\; \mathrm{HalfNormal}\!\big(\sigma_{\text{rw}} \mid 0.07\big)\;
\cdot\; \mathrm{LogNormal}\!\big(\alpha \mid \log 60, 0.5^2\big).
\end{aligned}
$$

## 5) –ü—Ä–æ–≥–Ω–æ–∑ (—Å–∏–º—É–ª—è—Ü–∏—è –≤–ø–µ—Ä—ë–¥)

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–≥–æ —Å—ç–º–ø–ª–∞ $\theta^{(m)}$:
$$
\Lambda_t^{(m)} = \sum_{s=1}^{S} w_s \, \tilde y_{t-s}^{(m)},\qquad
\mu_t^{(m)} = R_t^{(m)} \cdot \Lambda_t^{(m)},\qquad
\tilde y_t^{(m)} \sim \mathrm{NegBinomial}\!\big(\mu_t^{(m)},\alpha^{(m)}\big).
$$

–ì–¥–µ $\tilde y_{t-s}^{(m)}$ ‚Äî —Ñ–∞–∫—Ç—ã –Ω–∞ train –∏ —É–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ.

## 6) –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (—Ñ–æ—Ä–º–∞–ª—å–Ω–æ)

**Weekday‚Äëeffect** (–º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω–æ, —Å —Ü–µ–Ω—Ç—Ä–æ–≤–∫–æ–π):
$$
\gamma \sim \mathcal{N}(0,\sigma_\gamma^2 I_7),\quad
\tilde\gamma_d = \gamma_d - \frac{1}{7}\sum_{j=0}^6 \gamma_j,\quad
\mu_t \leftarrow \mu_t \cdot \exp\big(\tilde\gamma_{\mathrm{dow}(t)}\big).
$$

**Student‚Äët –∏–Ω–Ω–æ–≤–∞—Ü–∏–∏ –¥–ª—è RW:**
$$
\varepsilon_t \sim \mathrm{StudentT}(\nu,0,\sigma_{\text{rw}}),
$$
$\nu$ —Ñ–∏–∫—Å–∏—Ä—É–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10) –∏–ª–∏ –±–µ—Ä—ë–º —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä.

**Damped / Freeze –Ω–∞ —Ñ–æ—Ä–∫–∞—Å—Ç–µ:**
$$
\varepsilon_t \sim
\begin{cases}
\mathcal{N}(0,\sigma_{\text{rw,train}}^2), & t \le T_{\text{train}}-1,\\
\mathcal{N}(0,\sigma_{\text{rw,fore}}^2), & t > T_{\text{train}}-1.
\end{cases}
$$
–°—Ç–∞–≤–∏–º $\sigma_{\text{rw,fore}}\ll\sigma_{\text{rw,train}}$ –∏–ª–∏ $=0$.

## 7) –ú–µ—Ç—Ä–∏–∫–∏
$$
\mathrm{MAE}=\frac{1}{n}\sum_{t\in\mathcal{T}_{\text{fore}}}|y_t-\hat y_t|,\qquad
\mathrm{MAPE}=\frac{100\%}{n}\sum_{t\in\mathcal{T}_{\text{fore}}}\frac{|y_t-\hat y_t|}{\max(y_t,1)}.
$$
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–∞–∫–∂–µ WAPE, sMAPE –∏ MA‚Äë7‚Äë–≤–µ—Ä—Å–∏–∏.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –±–∞–π–µ—Å–æ–≤—Å–∫–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –≤—ã—è–≤–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏–∫—É —Ä–µ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∏—Å–ª–∞ R(t) –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ü–µ–Ω–∫–æ–π –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏.

### –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

1. **–ì–µ—Ä–º–∞–Ω–∏—è** –ø–æ–∫–∞–∑–∞–ª–∞ –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É —ç–ø–∏–¥–µ–º–∏–∏ —Å –ª—É—á—à–∏–º–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏ (MAPE = 20.8%)
2. **–ò—Ç–∞–ª–∏—è** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è (MAPE = 28.0%)
3. **–†–æ—Å—Å–∏—è** –∏–º–µ–µ—Ç —É–º–µ—Ä–µ–Ω–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ (MAPE = 39.2%)
4. **–§—Ä–∞–Ω—Ü–∏—è** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è (MAPE = 58.8%)
5. –ú–æ–¥–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ª–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã –≤ –¥–∏–Ω–∞–º–∏–∫–µ COVID-19
6. –ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –æ—Ü–µ–Ω–∫—É –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤

---

*–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö –∏–∑—É—á–µ–Ω–∏—è —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç–ø–∏–¥–µ–º–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö*
